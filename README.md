# Maternal Immunity as a Driver of Age-Specific RSV Disease

This repository contains the code and data for modelling the effects of maternally-derived immunity on age-specific patterns of RSV (Respiratory Syncytial Virus) disease in children, using Scottish surveillance data. The project explores baseline transmission dynamics, the impact of maternal vaccination, and sensitivity analyses.

## 📁 Repository Structure

There are three main directories in this project:

- **`data/`** — Contains all datasets required to run the analyses.
- **`code/`** — Contains all scripts necessary to model, fit, and plot the results.
- **`output/`** — Contains model outputs, intermediate data, and visualisations generated by the scripts.

---

## 🚀 How to Run the Project

### 1. Fit the model

Start in the `code/model` folder and run:

```r
fit_rsv.R
```

This script fits the RSV model to Scottish surveillance data.

Note:
The script uses a combinations object to define different scenarios. Specifically:
Combination 17 runs the baseline model.
Combinations 19, 20, and 21 test different durations of maternal immunity.

### 2. Generate results

Using the outputs from `fit_rsv.R`, navigate to the `code/plot` folder and run:

```r
main.R
```

This script processes the model outputs and generates all primary analysis figures and summary datasets.

### 3. Vaccination Scenario

To simulate and visualise the effects of maternal vaccination, run the following scripts:

```r
model_vaccination.R
plot_vaccination.R
```

Note:
To run a sensitivity analysis on the month of vaccine administration, re-run both scripts while modifying the `levels` argument in the `create_data()` function to change the timing of vaccination (e.g., 6th vs 7th month of gestation).

### 4. Supplementary Figures
To generate figures included in the supplementary materials, run:

```r
plot_supplements.R
```

### 📧 Contact

For questions, suggestions, or technical issues, please contact:
**Clara Brigitta**  
Email: [clara.brigitta@lshtm.ac.uk](mailto:clara.brigitta@lshtm.ac.uk)
